# ğŸ§  What is a Dockerfile?

A **Dockerfile** is simply a **text file** that contains a **set of instructions** for building a Docker image.
Each instruction tells Docker **how to set up the environment, what dependencies to install, and how to start your app.**

---

## Let's create a dockerfile for a node app

## ğŸš© Before Writing the Dockerfile

Make sure your Node.js project is ready:

- Your folder should have:

```pgsql
project/
â”œâ”€â”€ package.json
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ src/ or index.js
â””â”€â”€ (maybe .env, README, etc.)
```

- Ensure your app runs locally:

```bash
npm install
npm start
```

or whatever your start command is.

---

## ğŸ—ï¸ Steps to Create a Dockerfile

Weâ€™ll build it line by line, and Iâ€™ll explain each one.

### 1ï¸âƒ£ Start with a Base Image

Every Docker image starts from another image.

```dockerfile
FROM node:18
```

- node:18 = official Node.js image (comes with Node & npm preinstalled).
- You can use other versions like node:20 if needed.

---

### 2ï¸âƒ£ Set the Working Directory

Inside the container, weâ€™ll choose a folder where our code will live.

```dockerfile
WORKDIR /app
```

- This means: â€œAll future commands will run inside /app.â€

---

### 3ï¸âƒ£ Copy Package Files First

We copy only the files needed to install dependencies.

```dockerfile
COPY package*.json ./
```

- This copies package.json and package-lock.json into the container.
- Doing this first lets Docker cache dependencies (so you donâ€™t reinstall every time you rebuild).

---

### 4ï¸âƒ£ Install Dependencies

```dockerfile
RUN npm install
```

This installs all dependencies inside the container.

---

### 5ï¸âƒ£ Copy the Rest of Your Code

```dockerfile
COPY . .
```

Now all your source files go into the container.

---

### 6ï¸âƒ£ Expose the Port

If your Node app runs on a port (e.g., 8000 or 3000), you should tell Docker.

```dockerfile
EXPOSE 8000
```

This doesnâ€™t actually open the port â€” it just declares which one your app uses.

---

### 7ï¸âƒ£ Define the Command to Run Your App

Finally, we tell Docker how to start your app.

```dockerfile
CMD ["npm", "start"]
```

or if your main file is directly executable:

```dockerfile
CMD ["node", "index.js"]
```

---

# âœ… Final Dockerfile Example

Hereâ€™s a full working Dockerfile for a simple Node.js app:

```dockerfile
# 1. Use official Node image

FROM node:18

# 2. Set working directory

WORKDIR /app

# 3. Copy dependency files

COPY package\*.json ./

# 4. Install dependencies

RUN npm install

# 5. Copy the rest of the project files

COPY . .

# 6. Expose port

EXPOSE 8000

# 7. Start the app

CMD ["npm", "start"]
```

---

# ğŸ§© Folder Structure After Adding Dockerfile

```pgsql
project/
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ package.json
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ src/
â””â”€â”€ index.js
```

---

# ğŸ§ª Build and Run Commands

### Build the Docker image

```bash
docker build -t my-node-app .
```

`-t` = tag (naming your image)

### Run the container

```bash
docker run -it my-node-app
without mapping the port
```

Running container by mapping the port

```bash
docker run -p 8000:8000 my-node-app
```

Maps your local port 8000 â†’ containerâ€™s port 8000.

Now open `http://localhost:8000` in your browser.

```ruby
-p <host_port>:<container_port>
```

1. `-it`: Run this container interactively, and give me a terminal (like a shell).
2. `-p` (Port Mapping): Connects your local machineâ€™s port to the containerâ€™s port

---

## ğŸ§© What is Port Mapping?

When you run an app (like a Node.js server) inside a Docker container,  
it runs in an **isolated environment** â€” like a mini-computer inside your main computer.

So if your app runs on port `8001` inside the container, it is **not directly accessible** from your host (laptop or PC).

To make it accessible, we use **port mapping**.

---

## ğŸŒ Why Port Mapping is Necessary

By default, containers are isolated from your host network.  
This means your application runs _inside_ the container but your local machine canâ€™t access it unless you explicitly map the ports.

Port mapping allows your host machine and container to communicate.

---

## âš™ï¸ Port Mapping Syntax

```bash
docker run -p <host_port>:<container_port> <image_name>
```

---

### NOTE: Use `.dockerignore` to skip unnecessary files (like `node_modules`, `.env`, etc.).

### ğŸ§¾ Example `.dockerignore`

Create a file called `.dockerignore` next to your Dockerfile:

```lua
node_modules
npm-debug.log
Dockerfile
.dockerignore
.git
.gitignore
.env
```
